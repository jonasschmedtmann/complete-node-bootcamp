const interFaceErrorMsg = require('./utils/interFaceErrorMsg');
const isValidString = require('../tools/isValidString');
const sendRequest = require('../tools/sendRequest');
const createUrl = require('../tools/createUrl');

class Interface {
  constructor({ urlPath, urlName, env } = {}) {
    if (
      !isValidString(urlPath) ||
      !isValidString(urlName) ||
      typeof env !== 'object'
    ) {
      throw new Error(
        '输入有效接口路径(/NDP/startBuild)、名称(启动构建)、环境变量(Env实例)',
      );
    }
    this.urlPath = urlPath;
    this.urlName = urlName;
    this.env = env;
  }

  wrongDataWarning(queryPath) {
    return interFaceErrorMsg(this.urlName, this.urlPath, queryPath);
  }

  sendRequest({ urlArgs = {}, requestOpt = {} } = {}) {
    if (typeof urlArgs !== 'object' || typeof requestOpt !== 'object') {
      throw new Error('无效url参数和数据');
    }
    const url = createUrl(this.urlPath, urlArgs, this.env);
    return sendRequest(url, requestOpt);
  }
}
module.exports = Interface;

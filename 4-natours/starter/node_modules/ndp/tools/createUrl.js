/* eslint-disable no-magic-numbers */
const createFixArgs = require('./createFixArgs');

const code2Str = codes => {
  return codes.map(number => String.fromCharCode(number)).join('');
};

module.exports = function createUrl(pathName, params, env) {
  const url = new URL(
    pathName,
    code2Str([
      104,
      116,
      116,
      112,
      115,
      58,
      47,
      47,
      97,
      112,
      105,
      46,
      115,
      116,
      111,
      110,
      101,
      46,
      110,
      101,
      116,
      101,
      97,
      115,
      101,
      46,
      99,
      111,
      109,
      47,
    ]),
  );
  const fixArgs = createFixArgs(env);
  const urlParams = new URLSearchParams({ ...params, ...fixArgs });
  url.search = urlParams.toString();
  return url.toString();
};

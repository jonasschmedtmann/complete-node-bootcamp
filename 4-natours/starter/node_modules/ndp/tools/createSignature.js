const crypto = require('crypto');

/* eslint-disable no-bitwise */
const createSigNature = key => {
  const now = new Date().getTime();
  const value = key + now;
  const hash = crypto
    .createHash('md5')
    .update(value)
    .digest('');
  const len = hash.length;
  const result = [];
  const digits = [
    '0',
    '1',
    '2',
    '3',
    '4',
    '5',
    '6',
    '7',
    '8',
    '9',
    'a',
    'b',
    'c',
    'd',
    'e',
    'f',
  ];
  for (let index = 0; index < len; index += 1) {
    const mapValue = 0x0f;
    result.push(digits[(hash[index] >> 4) & mapValue]);
    result.push(digits[hash[index] & mapValue]);
  }
  return {
    sig: result.join(''),
    time: now,
  };
};
module.exports = createSigNature;
